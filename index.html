<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Casuarina Snacks ‚Äî Men√∫</title>
    <link rel="icon" href="casuarina.jpeg" type="image/jpeg" />
    <meta name="description"
        content="Men√∫ informativo de Casuarina Snacks. Conoce nuestra variedad de snacks y bebidas." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet" />

    <!-- Firebase initialization is now handled by firebase-config.js -->

    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #0b1318;
            --surface: #121d24;
            --card: #182028;
            --card-h: #1e2c36;
            --border: #243040;
            --teal: #1bc4c0;
            --teal2: #0fa8a4;
            --orange: #f97316;
            --orange2: #fb923c;
            --pink: #f472b6;
            --pink2: #ec4899;
            --yellow: #fbbf24;
            --text: #f1f5f9;
            --muted: #8da8b8;
            --radius: 1rem;
            --radius-sm: .65rem;
            --shadow: 0 8px 32px rgba(0, 0, 0, .5);
            --trans: .25s cubic-bezier(.4, 0, .2, 1);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 5px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(11, 19, 24, .9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            padding: .75rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: .75rem;
        }

        .logo img {
            height: 52px;
            width: 52px;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 0 0 2px rgba(27, 196, 192, .4), 0 2px 12px rgba(0, 0, 0, .4);
        }

        .logo-text-wrap {
            display: flex;
            flex-direction: column;
            line-height: 1.1;
        }

        .logo-name {
            font-size: 1.3rem;
            font-weight: 900;
            letter-spacing: -.5px;
            background: linear-gradient(90deg, var(--orange), var(--yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-sub {
            font-size: .7rem;
            font-weight: 600;
            color: var(--teal);
            letter-spacing: .12em;
            text-transform: uppercase;
        }

        /* Search bar */
        .search-wrap {
            flex: 1;
            max-width: 400px;
            position: relative;
        }

        .search-wrap input {
            width: 100%;
            padding: .55rem 1rem .55rem 2.5rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 2rem;
            color: var(--text);
            font-family: inherit;
            font-size: .9rem;
            outline: none;
            transition: border-color var(--trans), box-shadow var(--trans);
        }

        .search-wrap input:focus {
            border-color: var(--teal);
            box-shadow: 0 0 0 3px rgba(27, 196, 192, .15);
        }

        .search-wrap input::placeholder {
            color: var(--muted);
        }

        .search-icon {
            position: absolute;
            left: .75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted);
            pointer-events: none;
            font-size: .95rem;
        }

        /* Open badge */
        .open-badge {
            display: flex;
            align-items: center;
            gap: .35rem;
            background: rgba(27, 196, 192, .12);
            border: 1px solid rgba(27, 196, 192, .3);
            color: var(--teal);
            font-size: .78rem;
            font-weight: 700;
            padding: .35rem .75rem;
            border-radius: 2rem;
            white-space: nowrap;
        }

        .open-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: var(--teal);
            animation: blink 1.5s ease-in-out infinite;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: .25;
            }
        }

        /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
        .hero {
            text-align: center;
            padding: 3rem 1.5rem 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(ellipse 70% 60% at 20% 50%, rgba(249, 115, 22, .09) 0%, transparent 60%),
                radial-gradient(ellipse 70% 60% at 80% 50%, rgba(27, 196, 192, .09) 0%, transparent 60%),
                radial-gradient(ellipse 50% 40% at 50% 0%, rgba(244, 114, 182, .07) 0%, transparent 60%);
            pointer-events: none;
        }

        .hero-logo {
            width: 140px;
            height: 140px;
            object-fit: cover;
            border-radius: 50%;
            margin: 0 auto 1.2rem;
            display: block;
            box-shadow: 0 0 0 4px rgba(249, 115, 22, .35), 0 8px 32px rgba(249, 115, 22, .25);
            animation: float 4s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }
        }

        .hero h1 {
            font-size: clamp(1.8rem, 5vw, 2.8rem);
            font-weight: 900;
            letter-spacing: -1px;
            margin-bottom: .4rem;
        }

        .hero h1 .grad {
            background: linear-gradient(90deg, var(--orange), var(--yellow), var(--pink));
            background-size: 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 4s linear infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: 0%
            }

            100% {
                background-position: 200%
            }
        }

        .hero p {
            color: var(--muted);
            font-size: 1rem;
            max-width: 420px;
            margin: 0 auto;
        }

        /* Stats row */
        .stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-num {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--yellow);
        }

        .stat-label {
            font-size: .72rem;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: .08em;
        }

        /* ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ */
        .categories {
            display: flex;
            gap: .55rem;
            padding: 1.25rem 1.5rem;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .categories::-webkit-scrollbar {
            display: none;
        }

        .cat-btn {
            flex-shrink: 0;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 2rem;
            color: var(--muted);
            font-family: inherit;
            font-size: .88rem;
            font-weight: 600;
            padding: .42rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: .35rem;
            transition: all var(--trans);
            white-space: nowrap;
        }

        .cat-btn:hover {
            border-color: var(--teal);
            color: var(--text);
        }

        .cat-btn.active {
            background: linear-gradient(135deg, var(--teal2), var(--teal));
            border-color: transparent;
            color: #0b1318;
            font-weight: 800;
        }

        /* ‚îÄ‚îÄ SECTION LABEL ‚îÄ‚îÄ */
        .section-title {
            padding: 0 1.5rem .75rem;
            font-size: 1rem;
            font-weight: 700;
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: .5rem;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        .result-count {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 2rem;
            font-size: .72rem;
            font-weight: 700;
            color: var(--muted);
            padding: .1rem .55rem;
            margin-left: .4rem;
        }

        /* ‚îÄ‚îÄ GRID ‚îÄ‚îÄ */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
            gap: 1rem;
            padding: 0 1.5rem 3rem;
        }

        /* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
        .menu-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform .28s cubic-bezier(.34, 1.56, .64, 1), box-shadow .28s ease, border-color .28s ease;
            position: relative;
            cursor: pointer;
        }

        .menu-card:hover {
            transform: scale(2.3) translateY(-6px);
            box-shadow: 0 20px 56px rgba(0, 0, 0, .6), 0 0 0 1px rgba(249, 115, 22, .25);
            border-color: rgba(249, 115, 22, .35);
            z-index: 5;
        }

        /* Glow line on hover */
        .menu-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--orange), var(--teal), var(--pink));
            opacity: 0;
            transition: opacity var(--trans);
        }

        .menu-card:hover::before {
            opacity: 1;
        }

        .card-badges {
            position: absolute;
            top: .6rem;
            left: .6rem;
            display: flex;
            flex-direction: column;
            gap: .3rem;
            z-index: 2;
        }

        .badge {
            font-size: .62rem;
            font-weight: 800;
            letter-spacing: .05em;
            text-transform: uppercase;
            padding: .15rem .45rem;
            border-radius: .3rem;
            line-height: 1.4;
        }

        .badge-hot {
            background: var(--orange);
            color: #fff;
        }

        .badge-new {
            background: var(--teal);
            color: #0b1318;
        }

        .badge-pop {
            background: var(--pink);
            color: #fff;
        }

        .card-img {
            height: 120px;
            display: grid;
            place-items: center;
            font-size: 3.5rem;
            background: linear-gradient(160deg, var(--surface), var(--card-h));
            border-bottom: 1px solid var(--border);
            user-select: none;
            transition: transform var(--trans);
        }

        .menu-card:hover .card-img {
            transform: scale(1.1);
        }

        .card-body {
            padding: .85rem;
            display: flex;
            flex-direction: column;
            gap: .25rem;
            flex: 1;
        }

        .card-name {
            font-size: .98rem;
            font-weight: 800;
            line-height: 1.2;
        }

        .card-desc {
            font-size: .78rem;
            color: var(--muted);
            line-height: 1.45;
            flex: 1;
        }

        .card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: .65rem;
            padding-top: .6rem;
            border-top: 1px solid var(--border);
        }

        .card-price {
            font-size: 1.15rem;
            font-weight: 900;
            color: var(--yellow);
            display: flex;
            align-items: baseline;
            gap: .2rem;
        }

        .card-price .currency {
            font-size: .7rem;
            font-weight: 500;
            color: var(--muted);
        }

        .card-cat-pill {
            font-size: .65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: .06em;
            padding: .2rem .5rem;
            border-radius: 2rem;
            border: 1px solid var(--border);
            color: var(--muted);
        }

        /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
        .empty-state {
            grid-column: 1/-1;
            text-align: center;
            padding: 4rem 1rem;
            color: var(--muted);
        }

        .empty-state .empty-icon {
            font-size: 3rem;
            margin-bottom: .6rem;
        }

        .empty-state p {
            font-size: 1rem;
        }

        .empty-state strong {
            color: var(--text);
        }

        /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
        footer {
            text-align: center;
            padding: 2rem 1rem 1.5rem;
            border-top: 1px solid var(--border);
            color: var(--muted);
            font-size: .8rem;
        }

        footer .footer-logo {
            width: 48px;
            height: 48px;
            object-fit: cover;
            border-radius: 50%;
            margin: 0 auto .6rem;
            display: block;
            opacity: .7;
            box-shadow: 0 0 0 2px rgba(27, 196, 192, .25);
        }

        footer a {
            color: var(--teal);
            text-decoration: none;
        }

        /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
        @media (max-width: 580px) {
            .hero {
                padding: 2rem 1rem 1.5rem;
            }

            .categories {
                padding: 1rem;
            }

            .menu-grid {
                grid-template-columns: repeat(auto-fill, minmax(155px, 1fr));
                gap: .75rem;
                padding: 0 1rem 2rem;
            }

            .section-title {
                padding: 0 1rem .7rem;
            }

            .search-wrap {
                max-width: 180px;
            }

            .open-badge {
                display: none;
            }
        }

        /* ‚îÄ‚îÄ PRODUCT DETAIL MODAL ‚îÄ‚îÄ */
        .prod-overlay {
            position: fixed;
            inset: 0;
            z-index: 200;
            background: rgba(0, 0, 0, .75);
            backdrop-filter: blur(8px);
            display: grid;
            place-items: center;
            padding: 1rem;
            opacity: 0;
            pointer-events: none;
            transition: opacity .25s ease;
        }

        .prod-overlay.open {
            opacity: 1;
            pointer-events: all;
        }

        .prod-modal {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            width: min(440px, 100%);
            max-height: 92vh;
            overflow-y: auto;
            transform: scale(.88) translateY(20px);
            transition: transform .3s cubic-bezier(.34, 1.56, .64, 1);
            position: relative;
        }

        .prod-overlay.open .prod-modal {
            transform: scale(1) translateY(0);
        }

        .prod-modal-close {
            position: absolute;
            top: .7rem;
            right: .7rem;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: grid;
            place-items: center;
            cursor: pointer;
            font-size: 1rem;
            color: var(--muted);
            transition: all .2s ease;
            z-index: 3;
        }

        .prod-modal-close:hover {
            border-color: var(--red);
            color: var(--red);
        }

        .prod-modal-img {
            width: 100%;
            height: 220px;
            display: grid;
            place-items: center;
            background: linear-gradient(160deg, var(--card), var(--card-h));
            border-bottom: 1px solid var(--border);
            font-size: 6rem;
            overflow: hidden;
            position: relative;
        }

        .prod-modal-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            inset: 0;
        }

        .prod-modal-body {
            padding: 1.4rem;
        }

        .prod-modal-badges {
            display: flex;
            gap: .35rem;
            flex-wrap: wrap;
            margin-bottom: .7rem;
        }

        .prod-modal-name {
            font-size: 1.5rem;
            font-weight: 900;
            line-height: 1.15;
            margin-bottom: .5rem;
        }

        .prod-modal-desc {
            color: var(--muted);
            font-size: .95rem;
            line-height: 1.6;
            margin-bottom: 1.1rem;
        }

        .prod-modal-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: .9rem;
            border-top: 1px solid var(--border);
        }

        .prod-modal-price {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--yellow);
        }

        .prod-modal-price .currency {
            font-size: .85rem;
            font-weight: 500;
            color: var(--muted);
            margin-left: .2rem;
        }

        .prod-modal-cat {
            font-size: .7rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: .06em;
            padding: .3rem .7rem;
            border: 1px solid var(--border);
            border-radius: 2rem;
            color: var(--muted);
        }

        /* ‚îÄ‚îÄ CARD APPEAR ANIMATION ‚îÄ‚îÄ */
        .menu-card {
            animation: cardIn .3s ease backwards;
        }

        @keyframes cardIn {
            from {
                opacity: 0;
                transform: translateY(12px);
            }

            to {
                opacity: 1;
                transform: none;
            }
        }

        /* ‚îÄ‚îÄ CLOSED BANNER ‚îÄ‚îÄ */
        .closed-banner {
            background: linear-gradient(135deg, rgba(248, 113, 113, .15), rgba(220, 38, 38, .1));
            border-bottom: 2px solid rgba(248, 113, 113, .4);
            padding: .8rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: .6rem;
            font-size: .95rem;
            font-weight: 700;
            color: #f87171;
            text-align: center;
            flex-wrap: wrap;
        }

        .closed-banner.hidden {
            display: none;
        }

        .closed-icon {
            font-size: 1.2rem;
        }
    </style>
</head>

<body>

    <!-- ‚ïê‚ïê CLOSED BANNER ‚ïê‚ïê -->
    <div class="closed-banner hidden" id="closed-banner">
        <span class="closed-icon">üîí</span>
        <span>Estamos cerrados por el momento. ¬°Vuelve pronto!</span>
    </div>

    <!-- ‚ïê‚ïê HEADER ‚ïê‚ïê -->
    <header>
        <div class="logo">
            <img src="casuarina.jpeg" alt="Casuarina Snacks logo" id="header-logo" />
            <div class="logo-text-wrap">
                <span class="logo-name">Casuarina</span>
                <span class="logo-sub">Snacks &amp; Bebidas</span>
            </div>
        </div>

        <div class="search-wrap">
            <span class="search-icon">üîç</span>
            <input type="search" id="search-input" placeholder="Buscar producto..." autocomplete="off" />
        </div>

        <div class="open-badge" id="open-badge">
            <span class="open-dot"></span>
            <span id="badge-text">Abierto</span>
        </div>
    </header>

    <!-- ‚ïê‚ïê HERO ‚ïê‚ïê -->
    <section class="hero">
        <img src="casuarina.jpeg" alt="Casuarina Snacks" class="hero-logo" id="hero-logo" />
        <h1>Nuestro <span class="grad">Men√∫</span></h1>
        <p>Snacks, dulces y bebidas para todos los gustos. ¬°Elige tu favorito!</p>
        <div class="stats">
            <div class="stat">
                <div class="stat-num" id="stat-products">25</div>
                <div class="stat-label">Productos</div>
            </div>
            <div class="stat">
                <div class="stat-num">5</div>
                <div class="stat-label">Categor√≠as</div>
            </div>
            <div class="stat">
                <div class="stat-num">$8</div>
                <div class="stat-label">Desde MXN</div>
            </div>
        </div>
    </section>

    <!-- ‚ïê‚ïê CATEGORIES ‚ïê‚ïê -->
    <div class="categories" id="categories">
        <button class="cat-btn active" data-cat="todos">üåü Todos</button>
        <button class="cat-btn" data-cat="snacks">üçø Snacks</button>
        <button class="cat-btn" data-cat="dulces">üç¨ Dulces</button>
        <button class="cat-btn" data-cat="bebidas-frias">üßÉ Bebidas Fr√≠as</button>
        <button class="cat-btn" data-cat="bebidas-calientes">‚òï Bebidas Calientes</button>
        <button class="cat-btn" data-cat="saludable">ü•ó Saludable</button>
    </div>

    <!-- ‚ïê‚ïê SECTION LABEL ‚ïê‚ïê -->
    <p class="section-title" id="section-label">
        üî• Todos los productos
        <span class="result-count" id="result-count">25</span>
    </p>

    <!-- ‚ïê‚ïê MENU GRID ‚ïê‚ïê -->
    <div class="menu-grid" id="menu-grid"></div>

    <!-- ‚ïê‚ïê PRODUCT DETAIL MODAL ‚ïê‚ïê -->
    <div class="prod-overlay" id="prod-overlay">
        <div class="prod-modal" id="prod-modal">
            <button class="prod-modal-close" id="modal-close">‚úï</button>
            <div class="prod-modal-img" id="modal-img-wrap">
                <span id="modal-emoji"></span>
            </div>
            <div class="prod-modal-body">
                <div class="prod-modal-badges" id="modal-badges"></div>
                <div class="prod-modal-name" id="modal-name"></div>
                <div class="prod-modal-desc" id="modal-desc"></div>
                <div class="prod-modal-footer">
                    <div class="prod-modal-price">
                        <span id="modal-price"></span><span class="currency">MXN</span>
                    </div>
                    <span class="prod-modal-cat" id="modal-cat"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê FOOTER ‚ïê‚ïê -->
    <footer>
        <img src="casuarina.jpeg" alt="Casuarina Snacks" class="footer-logo" />
        <p><strong style="color:var(--text)">Casuarina Snacks</strong> &nbsp;‚Ä¢&nbsp; Snacks &amp; Bebidas</p>
        <p style="margin-top:.3rem;margin-bottom:.6rem;">Men√∫ de muestra ‚Äî datos pr√≥ximamente</p>
        <a href="admin.html" style="font-size:.75rem;color:var(--muted);text-decoration:none;opacity:.5;">‚öô
            Administrador</a>
    </footer>

    <script>
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           STORAGE
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        const STORAGE_PRODUCTS = 'casuarina_products';
        const STORAGE_STATUS = 'casuarina_status';

        const DEFAULT_PRODUCTS = [
            { id: 1, name: 'Palomitas de Ma√≠z', desc: 'Palomitas reci√©n hechas con mantequilla y sal.', price: 25, emoji: 'üçø', cat: 'snacks', badges: ['hot'], available: true },
            { id: 2, name: 'Papas Fritas', desc: 'Crujientes papas estilo kettle, en varios sabores.', price: 30, emoji: 'ü•î', cat: 'snacks', badges: ['pop'], available: true },
            { id: 3, name: 'Nachos con Queso', desc: 'Nachos dorados ba√±ados en salsa de queso caliente.', price: 45, emoji: 'ü´î', cat: 'snacks', badges: [], available: true },
            { id: 4, name: 'Hot Cheetos', desc: 'Botana de ma√≠z muy picosa, crujiente y adictiva.', price: 20, emoji: 'üå∂Ô∏è', cat: 'snacks', badges: ['pop'], available: true },
            { id: 5, name: 'Palomitas Ranch', desc: 'Palomitas sabor ranch con toque de queso.', price: 30, emoji: 'üçø', cat: 'snacks', badges: ['new'], available: true },
            { id: 6, name: 'Cacahuates Japones', desc: 'Cacahuates cubiertos de harina crujiente japonesa.', price: 18, emoji: 'ü•ú', cat: 'snacks', badges: [], available: true },
            { id: 7, name: 'Gomitas de Osito', desc: 'Gomitas de colores con sabores de frutas tropicales.', price: 15, emoji: 'üêª', cat: 'dulces', badges: ['pop'], available: true },
            { id: 8, name: 'Chocolates Surtidos', desc: 'Selecci√≥n de chocolates, leche, oscuro y almendra.', price: 35, emoji: 'üç´', cat: 'dulces', badges: [], available: true },
            { id: 9, name: 'Paleta de Tamarindo', desc: 'Paleta con chamoy, tamarindo y chile en polvo.', price: 12, emoji: 'üç≠', cat: 'dulces', badges: ['hot'], available: true },
            { id: 10, name: 'Mazap√°n', desc: 'Tradicional mazap√°n de cacahuate, suave y dulce.', price: 8, emoji: 'üü§', cat: 'dulces', badges: [], available: true },
            { id: 11, name: 'Rebanada de Pay', desc: 'Pay de manzana casero con canela y az√∫car.', price: 40, emoji: 'ü•ß', cat: 'dulces', badges: ['new'], available: true },
            { id: 12, name: 'Agua Fresca', desc: 'Agua de sand√≠a, horchata o jamaica. Refrescante.', price: 20, emoji: 'üçπ', cat: 'bebidas-frias', badges: ['pop'], available: true },
            { id: 13, name: 'Limonada', desc: 'Limonada natural con menta fresca y hielo.', price: 25, emoji: 'üçã', cat: 'bebidas-frias', badges: [], available: true },
            { id: 14, name: 'Smoothie de Fresa', desc: 'Batido de fresas naturales, leche y vainilla.', price: 40, emoji: 'üçì', cat: 'bebidas-frias', badges: ['new'], available: true },
            { id: 15, name: 'Refresco', desc: 'Variedad de refrescos fr√≠os de tu elecci√≥n.', price: 22, emoji: 'ü•§', cat: 'bebidas-frias', badges: [], available: true },
            { id: 16, name: 'Agua Mineral', desc: 'Agua mineral natural con gas para refrescarte.', price: 15, emoji: 'üíß', cat: 'bebidas-frias', badges: [], available: true },
            { id: 17, name: 'T√© Fr√≠o de Lim√≥n', desc: 'T√© helado con lim√≥n y miel, perfecto para el calor.', price: 28, emoji: 'üçµ', cat: 'bebidas-frias', badges: ['hot'], available: true },
            { id: 18, name: 'Caf√© Americano', desc: 'Caf√© de grano negro fuerte, servido bien caliente.', price: 30, emoji: '‚òï', cat: 'bebidas-calientes', badges: ['pop'], available: true },
            { id: 19, name: 'Caf√© con Leche', desc: 'Espresso suave con leche vaporizada y canela.', price: 35, emoji: 'üßã', cat: 'bebidas-calientes', badges: [], available: true },
            { id: 20, name: 'Chocolate Caliente', desc: 'Chocolate espeso cremoso con malvaviscos.', price: 38, emoji: 'üç´', cat: 'bebidas-calientes', badges: ['hot'], available: true },
            { id: 21, name: 'T√© de Manzanilla', desc: 'Tranquilo t√© de manzanilla con miel y lim√≥n.', price: 20, emoji: 'üåº', cat: 'bebidas-calientes', badges: [], available: true },
            { id: 22, name: 'Ensalada de Frutas', desc: 'Fruta fresca de temporada con chile y lim√≥n.', price: 35, emoji: 'üç±', cat: 'saludable', badges: ['new'], available: true },
            { id: 23, name: 'Mix de Nueces', desc: 'Mezcla de nueces, almendras y ar√°ndanos secos.', price: 45, emoji: 'ü•ú', cat: 'saludable', badges: [], available: true },
            { id: 24, name: 'Granola Bar', desc: 'Barra de granola con avena, miel y semillas.', price: 25, emoji: 'üåæ', cat: 'saludable', badges: ['pop'], available: true },
            { id: 25, name: 'Yogurt con Granola', desc: 'Yogurt natural con granola crujiente y miel de abeja.', price: 40, emoji: 'ü•õ', cat: 'saludable', badges: [], available: true },
        ];

        function getProducts() {
            // Prefer live Firestore data; fall back to localStorage then defaults
            if (window.__fsProducts && window.__fsProducts.length > 0) return window.__fsProducts;
            try { return JSON.parse(localStorage.getItem(STORAGE_PRODUCTS)) || DEFAULT_PRODUCTS; }
            catch { return DEFAULT_PRODUCTS; }
        }
        function getStatus() {
            return window.__fsStatus || localStorage.getItem(STORAGE_STATUS) || 'open';
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           STATUS BANNER
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        function applyStatus() {
            const s = getStatus();
            const banner = document.getElementById('closed-banner');
            const openBadge = document.getElementById('open-badge');
            const badgeText = document.getElementById('badge-text');
            if (s === 'closed') {
                banner.classList.remove('hidden');
                openBadge.style.background = 'rgba(248,113,113,.12)';
                openBadge.style.borderColor = 'rgba(248,113,113,.3)';
                openBadge.style.color = '#f87171';
                badgeText.textContent = 'Cerrado';
                document.querySelector('.open-dot').style.background = '#f87171';
            } else {
                banner.classList.add('hidden');
                openBadge.style.background = '';
                openBadge.style.borderColor = '';
                openBadge.style.color = '';
                badgeText.textContent = 'Abierto';
                document.querySelector('.open-dot').style.background = '';
            }
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           DATA
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        const CAT_LABELS = {
            'todos': 'üåü Todos los productos',
            'snacks': 'üçø Snacks',
            'dulces': 'üç¨ Dulces',
            'bebidas-frias': 'üßÉ Bebidas Fr√≠as',
            'bebidas-calientes': '‚òï Bebidas Calientes',
            'saludable': 'ü•ó Saludable',
        };
        const CAT_NAMES = {
            'snacks': 'Snack', 'dulces': 'Dulce', 'bebidas-frias': 'Bebida fr√≠a',
            'bebidas-calientes': 'Bebida caliente', 'saludable': 'Saludable'
        };

        const PRODUCTS = [
            // SNACKS
            { id: 1, name: 'Palomitas de Ma√≠z', desc: 'Palomitas reci√©n hechas con mantequilla y sal.', price: 25, emoji: 'üçø', cat: 'snacks', badges: ['hot'] },
            { id: 2, name: 'Papas Fritas', desc: 'Crujientes papas estilo kettle, en varios sabores.', price: 30, emoji: 'ü•î', cat: 'snacks', badges: ['pop'] },
            { id: 3, name: 'Nachos con Queso', desc: 'Nachos dorados ba√±ados en salsa de queso caliente.', price: 45, emoji: 'ü´î', cat: 'snacks', badges: [] },
            { id: 4, name: 'Hot Cheetos', desc: 'Botana de ma√≠z muy picosa, crujiente y adictiva.', price: 20, emoji: 'üå∂Ô∏è', cat: 'snacks', badges: ['pop'] },
            { id: 5, name: 'Palomitas Ranch', desc: 'Palomitas sabor ranch con toque de queso.', price: 30, emoji: 'üçø', cat: 'snacks', badges: ['new'] },
            { id: 6, name: 'Cacahuates Japones', desc: 'Cacahuates cubiertos de harina crujiente japonesa.', price: 18, emoji: 'ü•ú', cat: 'snacks', badges: [] },
            // DULCES
            { id: 7, name: 'Gomitas de Osito', desc: 'Gomitas de colores con sabores de frutas tropicales.', price: 15, emoji: 'üêª', cat: 'dulces', badges: ['pop'] },
            { id: 8, name: 'Chocolates Surtidos', desc: 'Selecci√≥n de chocolates, leche, oscuro y almendra.', price: 35, emoji: 'üç´', cat: 'dulces', badges: [] },
            { id: 9, name: 'Paleta de Tamarindo', desc: 'Paleta con chamoy, tamarindo y chile en polvo.', price: 12, emoji: 'üç≠', cat: 'dulces', badges: ['hot'] },
            { id: 10, name: 'Mazap√°n', desc: 'Tradicional mazap√°n de cacahuate, suave y dulce.', price: 8, emoji: 'üü§', cat: 'dulces', badges: [] },
            { id: 11, name: 'Rebanada de Pay', desc: 'Pay de manzana casero con canela y az√∫car.', price: 40, emoji: 'ü•ß', cat: 'dulces', badges: ['new'] },
            // BEBIDAS FR√çAS
            { id: 12, name: 'Agua Fresca', desc: 'Agua de sand√≠a, horchata o jamaica. Refrescante.', price: 20, emoji: 'üçπ', cat: 'bebidas-frias', badges: ['pop'] },
            { id: 13, name: 'Limonada', desc: 'Limonada natural con menta fresca y hielo.', price: 25, emoji: 'üçã', cat: 'bebidas-frias', badges: [] },
            { id: 14, name: 'Smoothie de Fresa', desc: 'Batido de fresas naturales, leche y vainilla.', price: 40, emoji: 'üçì', cat: 'bebidas-frias', badges: ['new'] },
            { id: 15, name: 'Refresco', desc: 'Variedad de refrescos fr√≠os de tu elecci√≥n.', price: 22, emoji: 'ü•§', cat: 'bebidas-frias', badges: [] },
            { id: 16, name: 'Agua Mineral', desc: 'Agua mineral natural con gas para refrescarte.', price: 15, emoji: 'üíß', cat: 'bebidas-frias', badges: [] },
            { id: 17, name: 'T√© Fr√≠o de Lim√≥n', desc: 'T√© helado con lim√≥n y miel, perfecto para el calor.', price: 28, emoji: 'üçµ', cat: 'bebidas-frias', badges: ['hot'] },
            // BEBIDAS CALIENTES
            { id: 18, name: 'Caf√© Americano', desc: 'Caf√© de grano negro fuerte, servido bien caliente.', price: 30, emoji: '‚òï', cat: 'bebidas-calientes', badges: ['pop'] },
            { id: 19, name: 'Caf√© con Leche', desc: 'Espresso suave con leche vaporizada y canela.', price: 35, emoji: 'üßã', cat: 'bebidas-calientes', badges: [] },
            { id: 20, name: 'Chocolate Caliente', desc: 'Chocolate espeso cremoso con malvaviscos.', price: 38, emoji: 'üç´', cat: 'bebidas-calientes', badges: ['hot'] },
            { id: 21, name: 'T√© de Manzanilla', desc: 'Tranquilo t√© de manzanilla con miel y lim√≥n.', price: 20, emoji: 'üåº', cat: 'bebidas-calientes', badges: [] },
            // SALUDABLE
            { id: 22, name: 'Ensalada de Frutas', desc: 'Fruta fresca de temporada con chile y lim√≥n.', price: 35, emoji: 'üç±', cat: 'saludable', badges: ['new'] },
            { id: 23, name: 'Mix de Nueces', desc: 'Mezcla de nueces, almendras y ar√°ndanos secos.', price: 45, emoji: 'ü•ú', cat: 'saludable', badges: [] },
            { id: 24, name: 'Granola Bar', desc: 'Barra de granola con avena, miel y semillas.', price: 25, emoji: 'üåæ', cat: 'saludable', badges: ['pop'] },
            { id: 25, name: 'Yogurt con Granola', desc: 'Yogurt natural con granola crujiente y miel de abeja.', price: 40, emoji: 'ü•õ', cat: 'saludable', badges: [] },
        ];

        /* ‚îÄ‚îÄ STATE ‚îÄ‚îÄ */
        let activeCategory = 'todos';
        let searchTerm = '';

        /* ‚îÄ‚îÄ DOM REFS ‚îÄ‚îÄ */
        const menuGrid = document.getElementById('menu-grid');
        const sectionLabel = document.getElementById('section-label');
        const resultCount = document.getElementById('result-count');
        const statProducts = document.getElementById('stat-products');
        const searchInput = document.getElementById('search-input');

        /* ‚îÄ‚îÄ LOGO FALLBACK ‚îÄ‚îÄ */
        document.querySelectorAll('img[src="casuarina.jpeg"]').forEach(img => {
            img.onerror = function () {
                if (this.classList.contains('hero-logo')) {
                    const span = document.createElement('span');
                    span.textContent = 'üçø';
                    span.style.cssText = 'font-size:5rem;display:block;margin:0 auto 1.2rem;animation:float 4s ease-in-out infinite;';
                    this.parentNode.replaceChild(span, this);
                } else if (this.id === 'header-logo') {
                    const span = document.createElement('span');
                    span.textContent = 'üçø';
                    span.style.cssText = 'font-size:2.2rem;width:52px;height:52px;display:grid;place-items:center;';
                    this.parentNode.replaceChild(span, this);
                } else {
                    this.style.display = 'none';
                }
            };
        });

        /* ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ */
        function renderProducts() {
            // Only show available products
            const allProducts = getProducts().filter(p => p.available !== false);
            const filtered = allProducts.filter(p => {
                const matchCat = activeCategory === 'todos' || p.cat === activeCategory;
                const matchSearch = p.name.toLowerCase().includes(searchTerm) ||
                    (p.desc || '').toLowerCase().includes(searchTerm);
                return matchCat && matchSearch;
            });

            resultCount.textContent = filtered.length;
            statProducts.textContent = allProducts.length;

            menuGrid.innerHTML = '';

            if (filtered.length === 0) {
                menuGrid.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">üòï</div>
          <p>Sin resultados para "<strong>${searchTerm || activeCategory}</strong>"</p>
        </div>`;
                return;
            }

            filtered.forEach((p, i) => {
                const badgeHTML = (p.badges || []).map(b => {
                    const labels = { hot: 'üî• Favorito', new: '‚ú® Nuevo', pop: '‚≠ê Popular' };
                    return `<span class="badge badge-${b}">${labels[b]}</span>`;
                }).join('');

                // Show photo if exists, else emoji
                const imgSection = p.imageUrl
                    ? `<div class="card-img" style="padding:0;overflow:hidden"><img src="${p.imageUrl}" alt="${p.name}" style="width:100%;height:100%;object-fit:cover" loading="lazy" /></div>`
                    : `<div class="card-img">${p.emoji || 'üçø'}</div>`;

                const card = document.createElement('div');
                card.className = 'menu-card';
                card.style.animationDelay = `${i * 0.04}s`;
                card.innerHTML = `
        <div class="card-badges">${badgeHTML}</div>
        ${imgSection}
        <div class="card-body">
          <div class="card-name">${p.name}</div>
          <div class="card-desc">${p.desc || ''}</div>
          <div class="card-footer">
            <div class="card-price">$${p.price}<span class="currency">MXN</span></div>
            <span class="card-cat-pill">${CAT_NAMES[p.cat] || p.cat}</span>
          </div>
        </div>`;

                // Click/tap ‚Üí open detail modal
                card.addEventListener('click', () => openProdModal(p));
                menuGrid.appendChild(card);
            });
        }

        /* ‚îÄ‚îÄ CATEGORIES ‚îÄ‚îÄ */
        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                activeCategory = btn.dataset.cat;
                sectionLabel.childNodes[0].textContent = CAT_LABELS[activeCategory] + ' ';
                renderProducts();
            });
        });

        /* ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ */
        searchInput.addEventListener('input', e => {
            searchTerm = e.target.value.toLowerCase().trim();
            if (searchTerm) {
                sectionLabel.childNodes[0].textContent = `üîç Resultados para "${e.target.value.trim()}" `;
            } else {
                sectionLabel.childNodes[0].textContent = CAT_LABELS[activeCategory] + ' ';
            }
            renderProducts();
        });

        /* ‚îÄ‚îÄ PRODUCT DETAIL MODAL ‚îÄ‚îÄ */
        const prodOverlay = document.getElementById('prod-overlay');

        function openProdModal(p) {
            const badgeLabels = { hot: 'üî• Favorito', new: '‚ú® Nuevo', pop: '‚≠ê Popular' };
            const badgeCls = { hot: 'badge-hot', new: 'badge-new', pop: 'badge-pop' };
            document.getElementById('modal-badges').innerHTML =
                (p.badges || []).map(b => `<span class="badge ${badgeCls[b]}">${badgeLabels[b]}</span>`).join('');
            document.getElementById('modal-name').textContent = p.name;
            document.getElementById('modal-desc').textContent = p.desc || '';
            document.getElementById('modal-price').textContent = `$${p.price}`;
            document.getElementById('modal-cat').textContent = CAT_NAMES[p.cat] || p.cat;

            // Image or emoji
            const wrap = document.getElementById('modal-img-wrap');
            const emoji = document.getElementById('modal-emoji');
            const existingImg = wrap.querySelector('img');
            if (existingImg) existingImg.remove();
            if (p.imageUrl) {
                const img = document.createElement('img');
                img.src = p.imageUrl; img.alt = p.name;
                wrap.appendChild(img);
                emoji.style.display = 'none';
            } else {
                emoji.textContent = p.emoji || 'üçø';
                emoji.style.display = '';
            }
            prodOverlay.classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeProdModal() {
            prodOverlay.classList.remove('open');
            document.body.style.overflow = '';
        }

        document.getElementById('modal-close').addEventListener('click', closeProdModal);
        prodOverlay.addEventListener('click', e => { if (e.target === prodOverlay) closeProdModal(); });
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeProdModal(); });

        /* ‚îÄ‚îÄ INIT ‚îÄ‚îÄ */
        // Expose to window so the Firebase module script can trigger re-renders
        window.renderProducts = renderProducts;
        window.applyStatus = applyStatus;
        applyStatus();
        renderProducts();
    </script>

    <!-- ‚ïê‚ïê FIRESTORE REAL-TIME LISTENER ‚ïê‚ïê -->
    <script type="module">
        import { db } from './firebase-config.js';
        import { collection, doc, onSnapshot }
            from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // ‚Äî Products: listen for any change and re-render immediately
        onSnapshot(collection(db, 'productos'), (snapshot) => {
            window.__fsProducts = snapshot.docs.map(d => ({ firestoreId: d.id, ...d.data() }));
            if (typeof window.renderProducts === 'function') window.renderProducts();
        }, (err) => { console.warn('[Firestore products]', err); });

        // ‚Äî Status: listen for open/closed changes
        onSnapshot(doc(db, 'config', 'negocio'), (snap) => {
            window.__fsStatus = snap.exists() ? (snap.data().status || 'open') : 'open';
            if (typeof window.applyStatus === 'function') window.applyStatus();
        }, (err) => { console.warn('[Firestore status]', err); });
    </script>
</body>

</html>
